<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tienda en LÃ­nea</title>
  <style>
    body { font-family: Arial; margin: 0; padding: 0; }
    .grupo, .producto, .resumen, .formulario { padding: 10px; border-bottom: 1px solid #ccc; }
    .grupo img, .producto img { width: 100%; max-width: 150px; display: block; }
    .grupo, .producto { cursor: pointer; text-align: center; }
    .carrito-btn { position: fixed; top: 10px; right: 10px; background: green; color: #fff; padding: 10px; border-radius: 50%; }
    #modalResumen { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; }
    #modalResumen.active { display: flex; }
    .resumen-container { background: #fff; padding: 20px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; border-radius: 10px; }
    .total { font-weight: bold; font-size: 18px; margin-top: 10px; }
  </style>
</head>
<body>

<div id="grupos" class="grupo-lista"></div>
<div id="productos" class="producto-lista"></div>
<button id="abrirResumen" class="carrito-btn">ðŸ›’<span id="contador">0</span></button>

<div id="modalResumen">
  <div class="resumen-container">
    <h2>Resumen del Pedido</h2>
    <div id="resumenProductos"></div>
    <div class="total" id="totalGeneral"></div>

    <form id="formulario-pedido">
      <input type="text" name="nombre" id="nombre" placeholder="Tu nombre" required><br>
      <input type="tel" name="telefono" id="telefono" placeholder="Tu telÃ©fono" required><br>
      <textarea id="detalles" name="detalles" rows="5" readonly></textarea><br>
      <button type="submit">Enviar Pedido</button>
      <button type="button" onclick="cerrarResumen()">Cancelar</button>
    </form>
  </div>
</div>

<script>
  const grupos = [
    { nombre: "Mosquiteros", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/mosquitero.jpg" },
    { nombre: "CosmÃ©ticos", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/cosmeticos.jpg" },
    { nombre: "Extensiones para cabello", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/extensiones.jpg" },
    { nombre: "Accesorios para bebÃ©s", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/bebes.jpg" },
    { nombre: "Productos escolares", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/escolares.jpg" },
    { nombre: "Mochilas", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/mochilas.jpg" },
    { nombre: "Peluches", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/peluches.jpg" },
    { nombre: "MueblerÃ­a", imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/muebleria.jpg" }
  ];

  const productosPorGrupo = {
    "Mosquiteros": [
      { nombre: "Mosquitero 1.5m", precio: 10, imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/mosquitero.jpg" },
      { nombre: "Mosquitero 2.0m", precio: 12, imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/mosquitero.jpg" }
    ],
    "CosmÃ©ticos": [
      { nombre: "Labial", precio: 4, imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/cosmeticos.jpg" },
      { nombre: "Sombras", precio: 6, imagen: "https://raw.githubusercontent.com/esauvh/imagenes/main/cosmeticos.jpg" }
    ]
    // Agrega mÃ¡s productos para cada grupo segÃºn necesites
  };

  const gruposContainer = document.getElementById('grupos');
  const productosContainer = document.getElementById('productos');
  const resumenProductos = document.getElementById('resumenProductos');
  const totalGeneral = document.getElementById('totalGeneral');
  const formularioPedido = document.getElementById('formulario-pedido');
  const textareaDetalles = document.getElementById('detalles');
  const modalResumen = document.getElementById('modalResumen');
  const contador = document.getElementById('contador');

  let carrito = [];

  grupos.forEach(grupo => {
    const div = document.createElement('div');
    div.className = 'grupo';
    div.innerHTML = `<img src="${grupo.imagen}" alt="${grupo.nombre}"><strong>${grupo.nombre}</strong>`;
    div.onclick = () => mostrarProductos(grupo.nombre);
    gruposContainer.appendChild(div);
  });

  function mostrarProductos(nombreGrupo) {
    productosContainer.innerHTML = '';
    const productos = productosPorGrupo[nombreGrupo] || [];
    productos.forEach(p => {
      const div = document.createElement('div');
      div.className = 'producto';
      div.innerHTML = `
        <img src="${p.imagen}" alt="${p.nombre}">
        <p>${p.nombre} - $${p.precio}</p>
        <input type="number" value="1" min="1" id="cantidad-${p.nombre.replace(/\s/g, '')}">
        <button onclick='agregarAlCarrito(${JSON.stringify(p)}, "${p.nombre.replace(/\s/g, '')}")'>Agregar</button>
      `;
      productosContainer.appendChild(div);
    });
  }

  function agregarAlCarrito(producto, idCantidad) {
    const cantidad = parseInt(document.getElementById("cantidad-" + idCantidad).value) || 1;
    carrito.push({ ...producto, cantidad });
    actualizarContador();
    alert("Producto agregado al carrito.");
  }

  function actualizarContador() {
    contador.textContent = carrito.length;
  }

  document.getElementById('abrirResumen').addEventListener('click', () => {
    if (carrito.length === 0) {
      alert("El carrito estÃ¡ vacÃ­o.");
      return;
    }
    mostrarResumen();
    modalResumen.classList.add('active');
  });

  function mostrarResumen() {
    resumenProductos.innerHTML = '';
    let total = 0;
    let texto = "";
    carrito.forEach(item => {
      const subtotal = item.precio * item.cantidad;
      total += subtotal;
      texto += `${item.nombre} x${item.cantidad} - $${subtotal}\n`;
      resumenProductos.innerHTML += `<p>${item.nombre} x${item.cantidad} = $${subtotal}</p>`;
    });
    totalGeneral.textContent = "Total: $" + total;
    textareaDetalles.value = texto + `\nTOTAL: $${total}`;
  }

  function cerrarResumen() {
    modalResumen.classList.remove('active');
  }

  formularioPedido.addEventListener('submit', (e) => {
    e.preventDefault();

    if(carrito.length === 0){
      alert("El carrito estÃ¡ vacÃ­o. Agrega productos antes de enviar.");
      return;
    }

    const nombre = document.getElementById('nombre').value;
    const telefono = document.getElementById('telefono').value;
    const detalles = textareaDetalles.value;

    const formData = new FormData();
    formData.append("Nombre", nombre);
    formData.append("TelÃ©fono", telefono);
    formData.append("Pedido", detalles);

    fetch("https://formsubmit.co/ajax/yoselyn96vasquez@gmail.com", {
      method: "POST",
      body: formData,
      headers: { 'Accept': 'application/json' }
    })
    .then(response => {
      if (response.ok) {
        alert("Pedido enviado correctamente. Gracias por tu compra.");
        carrito = [];
        actualizarContador();
        cerrarResumen();
        productosContainer.innerHTML = '';
        formularioPedido.reset();
      } else {
        return response.json().then(data => {
          throw new Error(data.message || "Error al enviar pedido");
        });
      }
    })
    .catch(error => {
      alert("Error al enviar el pedido: " + error.message);
    });
  });
</script>

</body>
</html>
