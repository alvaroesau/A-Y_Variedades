<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tienda Online - A&Y Variedades</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1a3a4d;
      color: white;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      color: #fcd000;
      text-align: center;
    }
    .grupos {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-bottom: 30px;
    }
    .grupo {
      background: #0c1e2c;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      width: 150px;
      text-align: center;
      transition: transform 0.3s, background-color 0.3s;
    }
    .grupo img {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 8px;
    }
    .grupo:hover {
      background-color: #fcd000;
      color: #000;
      transform: scale(1.05);
    }
    .productos {
      max-width: 600px;
      margin: 0 auto 40px;
    }
    .producto {
      background: #0c1e2c;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .producto img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 5px;
      cursor: pointer;
    }
    button {
      background-color: #fcd000;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #e0b800;
    }
    #carrito-icono {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #0c1e2c;
      border: 2px solid #fcd000;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 999;
      color: white;
      font-size: 24px;
    }
    #carrito-icono span {
      position: absolute;
      top: -5px;
      right: -5px;
      background: red;
      color: white;
      font-size: 12px;
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 50%;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: #0c1e2c;
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      color: white;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 0 15px #fcd000;
      position: relative;
    }
    .modal-content input,
    .modal-content textarea {
      width: 100%;
      font-size: 1rem;
      padding: 8px;
      border-radius: 5px;
      border: none;
      margin: 10px 0;
      box-sizing: border-box;
    }
    .pedido-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      border-bottom: 1px solid #444;
      padding-bottom: 5px;
    }
    .pedido-item span {
      flex: 1;
      text-align: left;
    }
    .pedido-item input {
      width: 50px;
      margin: 0 10px;
    }
    .btn-flotante {
      position: fixed;
      bottom: 20px;
      width: 50px;
      height: 50px;
      font-size: 24px;
      color: white;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      text-decoration: none;
      z-index: 9999;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    .btn-flotante.wsp { right: 20px; background: #25d366; }
    .btn-flotante.fb { right: 80px; background: #1877f2; }
    #modal-imagen {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background-color: rgba(0,0,0,0.8);
      justify-content: center;
      align-items: center;
      z-index: 2000;
    }
    #modal-imagen img {
      max-width: 90vw;
      max-height: 90vh;
      border-radius: 10px;
    }
    .total {
      font-weight: bold;
      color: #fcd000;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<h1>Elige un grupo de productos</h1>
<div id="carrito-icono" onclick="abrirResumen()">ðŸ›’<span id="contador-carrito">0</span></div>
<div class="grupos" id="grupos-container"></div>
<div class="productos" id="productos-container"></div>

<!-- Modal cantidad -->
<div class="modal" id="modal-cantidad">
  <div class="modal-content">
    <h3 id="modal-producto-nombre">Producto</h3>
    <input type="number" id="cantidad-input" min="1" value="1" />
    <button id="agregar-carrito-btn">Agregar al carrito</button>
    <button onclick="cerrarModal()">Cancelar</button>
  </div>
</div>

<!-- Modal resumen -->
<div class="modal" id="modal-resumen">
  <div class="modal-content">
    <h3>Resumen del Pedido</h3>
    <div id="lista-pedido"></div>
    <div class="total" id="total-general"></div>
    <form id="formulario-pedido">
      <input type="text" name="nombre" placeholder="Tu nombre" required />
      <input type="number" name="email" placeholder="Tu NÃºmero de contacto" required />
      <textarea name="detalles" readonly></textarea>
      <button type="submit">Enviar Pedido</button>
    </form>
    <button onclick="cerrarResumen()">Cerrar</button>
  </div>
</div>

<!-- Modal imagen -->
<div id="modal-imagen" onclick="cerrarImagenAmpliada()">
  <img id="imagen-ampliada" src="" alt="Vista ampliada" />
</div>

<a href="https://wa.me/50374656746?text=Hola%2C%20quiero%20hacer%20un%20pedido" class="btn-flotante wsp" target="_blank"><i class="fab fa-whatsapp"></i></a>
<a href="https://www.facebook.com/ay.variedades" class="btn-flotante fb" target="_blank"><i class="fab fa-facebook-f"></i></a>

<script>
  const imagenesGrupos = {
    "Mosquiteros": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/MO1.jpg",
    "CosmÃ©ticos": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/1.jpg",
    "Extensiones para cabello": "https://via.placeholder.com/150?text=Extensione",
    "Accesorios para bebÃ©s": "https://via.placeholder.com/150?text=BebÃ©s",
    "Producto escolar": "https://via.placeholder.com/150?text=Escolar",
    "Mochilas": "https://via.placeholder.com/150?text=Mochilas",
    "Peluches": "https://via.placeholder.com/150?text=Peluches",
    "MueblerÃ­a": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M7.jpg"
  };

  const imagenesProductos = {
    "Mosquitero sencillo": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/MO2.jpg",
    "Mosquitero doble": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/MO3.jpg",
    "Labial": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/2.jpg",
    "Base": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/3.jpg",
    "Labial2": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/1.jpg",
    "ExtensiÃ³n rizada": "https://via.placeholder.com/150?text=ExtensiÃ³n",
    "Chupete": "https://via.placeholder.com/150?text=Chupete",
    "Cuaderno": "https://via.placeholder.com/150?text=Cuaderno",
    "Mochila casual": "https://via.placeholder.com/150?text=Mochila",
    "Osito": "https://via.placeholder.com/150?text=Osito",
    "frocen": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M1.jpg",
    "caty": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M2.jpg",
    "mesa1": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M3.jpg",
    "mesa2": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M4.jpg",
    "zapatera1": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M5.jpg",
    "zapatera2": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M6.jpg",
    "zapatera3": "https://raw.githubusercontent.com/alvaroesau/A-Y_Variedades/main/M7.jpg"
  };

  const tienda = {
    "Mosquiteros": ["Mosquitero sencillo", "Mosquitero doble"],
    "CosmÃ©ticos": ["Labial", "Base", "Labial2"],
    "Extensiones para cabello": ["ExtensiÃ³n rizada"],
    "Accesorios para bebÃ©s": ["Chupete"],
    "Producto escolar": ["Cuaderno"],
    "Mochilas": ["Mochila casual"],
    "Peluches": ["Osito"],
    "MueblerÃ­a": ["frocen","caty","mesa1","mesa2","zapatera1","zapatera2","zapatera3"]
  };

  const gruposContainer = document.getElementById('grupos-container');
  const productosContainer = document.getElementById('productos-container');
  const modal = document.getElementById('modal-cantidad');
  const modalProductoNombre = document.getElementById('modal-producto-nombre');
  const cantidadInput = document.getElementById('cantidad-input');
  const agregarCarritoBtn = document.getElementById('agregar-carrito-btn');
  const contadorCarrito = document.getElementById('contador-carrito');
  const modalResumen = document.getElementById('modal-resumen');
  const listaPedido = document.getElementById('lista-pedido');
  const formularioPedido = document.getElementById('formulario-pedido');
  const textareaDetalles = formularioPedido.querySelector('textarea');
  const totalGeneral = document.getElementById('total-general');
  const modalImagen = document.getElementById('modal-imagen');
  const imagenAmpliada = document.getElementById('imagen-ampliada');

  let carrito = [];
  let productoActual = null;

  Object.keys(tienda).forEach(grupo => {
    const div = document.createElement('div');
    div.className = 'grupo';
    div.innerHTML = `<img src="${imagenesGrupos[grupo]}" alt="${grupo}"><div>${grupo}</div>`;
    div.addEventListener('click', () => mostrarProductos(grupo));
    gruposContainer.appendChild(div);
  });

  function mostrarProductos(grupo) {
    productosContainer.innerHTML = `<h2>${grupo}</h2>`;
    tienda[grupo].forEach(producto => {
      const imgURL = imagenesProductos[producto] || 'https://via.placeholder.com/150?text=Producto';
      const div = document.createElement('div');
      div.className = 'producto';
      div.innerHTML = `
        <div style="display:flex; align-items:center; gap:10px;">
          <img src="${imgURL}" alt="${producto}" onclick="verImagen('${imgURL}')" />
          <span>${producto}</span>
        </div>
        <button onclick="abrirModal('${producto}')">Pedir</button>
      `;
      productosContainer.appendChild(div);
    });
  }

  function abrirModal(producto) {
    productoActual = producto;
    modalProductoNombre.textContent = producto;
    cantidadInput.value = 1;
    modal.classList.add('active');
  }

  function cerrarModal() {
    modal.classList.remove('active');
  }

  function verImagen(url) {
    imagenAmpliada.src = url;
    modalImagen.style.display = 'flex';
  }

  function cerrarImagenAmpliada() {
    modalImagen.style.display = 'none';
  }

  agregarCarritoBtn.addEventListener('click', () => {
    const cantidad = parseInt(cantidadInput.value);
    if (!cantidad || cantidad < 1) return;
    const existente = carrito.find(p => p.producto === productoActual);
    if (existente) {
      existente.cantidad += cantidad;
    } else {
      carrito.push({ producto: productoActual, cantidad });
    }
    cerrarModal();
    actualizarContador();
  });

  function actualizarContador() {
    const total = carrito.reduce((sum, p) => sum + p.cantidad, 0);
    contadorCarrito.textContent = total;
  }

  function abrirResumen() {
    listaPedido.innerHTML = '';
    let total = 0;
    carrito.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'pedido-item';
      const subtotal = item.cantidad * 1; // Puedes ajustar precios reales aquÃ­
      total += subtotal;
      div.innerHTML = `
        <span>${item.producto} x${item.cantidad}</span>
        <input type="number" value="${item.cantidad}" min="1" onchange="cambiarCantidad(${index}, this.value)" />
        <button onclick="eliminarProducto(${index})">Eliminar</button>
      `;
      listaPedido.appendChild(div);
    });
    totalGeneral.textContent = `Total: $${total.toFixed(2)}`;
    textareaDetalles.value = carrito.map(p => `${p.producto} x${p.cantidad}`).join('\n');
    modalResumen.classList.add('active');
  }

  function cerrarResumen() {
    modalResumen.classList.remove('active');
  }

  function cambiarCantidad(index, nuevaCantidad) {
    const val = parseInt(nuevaCantidad);
    if (val >= 1) {
      carrito[index].cantidad = val;
      abrirResumen();
    }
  }

  function eliminarProducto(index) {
    carrito.splice(index, 1);
    abrirResumen();
  }

  formularioPedido.addEventListener('submit', e => {
    e.preventDefault();
    if (carrito.length === 0) return alert("Agrega productos al carrito primero.");
    const formData = new FormData(formularioPedido);
    fetch("https://formsubmit.co/ajax/yoselyn96vasquez@gmail.com", {
      method: "POST",
      body: formData,
      headers: { 'Accept': 'application/json' }
    })
    .then(res => res.ok ? res.json() : Promise.reject(res))
    .then(() => {
      alert("Pedido enviado correctamente.");
      carrito = [];
      actualizarContador();
      cerrarResumen();
      productosContainer.innerHTML = '';
      formularioPedido.reset();
    })
    .catch(() => alert("Error al enviar el pedido."));
  });
</script>

</body>
</html>
